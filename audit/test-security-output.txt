PASS  tests/security.attacks.test.ts
Security - Attack Prevention Tests (Scenario 2)
  REST API - NoSQL Injection Prevention
    ✓ should reject NoSQL injection attempt #1 ...
    ✓ should reject NoSQL injection attempt #2 ...
    ✓ should reject NoSQL injection attempt #3 ...
    ✓ should reject NoSQL injection attempt #4 ...
    ✓ should reject NoSQL injection attempt #5 ...
    ✓ should reject NoSQL injection attempt #6 ...
    ✓ should reject NoSQL injection attempt #7 ...
    ✓ should reject NoSQL injection attempt #8 ...
  REST API - XSS Prevention
    ✓ should reject XSS payloads in registration and room creation (10 cases)
  REST API - SQL Injection Prevention
    ✓ all SQL-like injection patterns rejected
  REST API - Command Injection Prevention
    ✓ all command injection patterns rejected
  REST API - Path Traversal Prevention
    ✓ all path traversal attempts rejected
  REST API - Prototype Pollution Prevention
    ✓ prototype pollution attempts rejected
  REST API - Buffer Overflow Prevention
    ✓ extremely long fields rejected
  REST API - Invalid Data Types / Missing Fields / Invalid Emails
    ✓ all invalid input cases rejected

Test Suites: 1 passed, 1 total
Tests:       81 passed, 81 total
Snapshots:   0 total
Time:        ~4.4s

Note: Jest coverage thresholds in `jest.config.js` are strict; CI may fail if global coverage thresholds are enforced. The functional security tests themselves passed.

> triviando-backend@1.0.0 test:security
> jest tests/security.attacks.test.ts --detectOpenHandles

  console.log
    [dotenv@17.2.3] injecting env (7) from .env -- tip: ÔÜÖ´©Å  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: ­ƒôí add observability to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Swagger available at /api/v1/docs

      at Object.log [as info] (src/utils/logger.ts:7:37)

  console.log
    MongoDB connected

      at Object.log [as info] (src/utils/logger.ts:7:37)

  console.log
    
    === VALIDATION COVERAGE REPORT ===

      at Object.<anonymous> (tests/security.attacks.test.ts:491:15)

  console.log
    Total validated endpoints: 8

      at Object.<anonymous> (tests/security.attacks.test.ts:492:15)

  console.log
    All endpoints use Zod validation middleware

      at Object.<anonymous> (tests/security.attacks.test.ts:493:15)

  console.log
    Validation coverage: 100%

      at Object.<anonymous> (tests/security.attacks.test.ts:494:15)

  console.log
    ===================================

      at Object.<anonymous> (tests/security.attacks.test.ts:495:15)

---------------------------|---------|----------|---------|---------|------------------------------
File                       | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s            
---------------------------|---------|----------|---------|---------|------------------------------
All files                  |   12.44 |     1.68 |    4.51 |   11.41 |                              
 controllers               |   19.36 |        0 |       0 |   16.49 |                              
  auth.controller.ts       |   24.07 |        0 |       0 |    18.6 | 8-25,30-45,50-59,64-74,79-83 
  gameResult.controller.ts |      20 |        0 |       0 |   16.66 | 8-25,30-60                   
  room.controller.ts       |   16.49 |        0 |       0 |   14.94 | 15-66,74-94,102-169          
  trivia.controller.ts     |   19.35 |        0 |       0 |   17.85 | 10-56                        
 middleware                |   36.14 |    13.15 |   55.55 |   29.72 |                              
  auth.middleware.ts       |   72.22 |       50 |     100 |   70.58 | 13-14,22,29-30               
  errorHandler.ts          |   27.27 |        0 |       0 |   22.22 | 6-12                         
  socketAuth.ts            |       0 |        0 |       0 |       0 | 2-34                         
  validate.ts              |   45.16 |     8.33 |   66.66 |      32 | 7-8,13,18-26,31-40           
 models                    |   56.75 |        0 |       0 |      60 |                              
  gameResult.model.ts      |     100 |      100 |     100 |     100 |                              
  room.model.ts            |      36 |        0 |       0 |   39.13 | 31,56,70,74,81-86,91-96      
  trivia.model.ts          |     100 |      100 |     100 |     100 |                              
  user.model.ts            |     100 |      100 |     100 |     100 |                              
 queues                    |       0 |        0 |       0 |       0 |                              
  bullmq.ts                |       0 |      100 |       0 |       0 | 1-16                         
  timers.queue.ts          |       0 |        0 |       0 |       0 | 1-23                         
 schemas                   |   73.68 |      100 |     100 |   73.68 |                              
  auth.ts                  |     100 |      100 |     100 |     100 |                              
  common.ts                |     100 |      100 |     100 |     100 |                              
  game.ts                  |       0 |      100 |     100 |       0 | 1-15                         
  room.ts                  |     100 |      100 |     100 |     100 |                              
  trivia.ts                |     100 |      100 |     100 |     100 |                              
 services                  |    0.77 |        0 |       0 |    0.88 |                              
  game.service.ts          |       0 |        0 |       0 |       0 | 1-161                        
  joinRoom.service.ts      |   14.28 |        0 |       0 |   18.18 | 11-39                        
  timers.handlers.ts       |       0 |        0 |       0 |       0 | 2-227                        
 socket                    |       0 |        0 |       0 |       0 |                              
  game.handlers.ts         |       0 |        0 |       0 |       0 | 2-404                        
  index.ts                 |       0 |        0 |       0 |       0 | 1-34                         
  ioRef.ts                 |       0 |      100 |       0 |       0 | 3-10                         
  room.handlers.ts         |       0 |        0 |       0 |       0 | 2-184                        
  validateSocket.ts        |       0 |        0 |       0 |       0 | 1-29                         
 utils                     |    43.1 |    16.66 |    5.88 |   38.46 |                              
  generateToken.ts         |      50 |        0 |       0 |      40 | 4-9                          
  logger.ts                |   72.72 |    33.33 |      25 |   72.72 | 8-10                         
  passwordUtils.ts         |    62.5 |      100 |       0 |      50 | 4-5,9                        
  redisChat.ts             |       0 |      100 |       0 |       0 | 1-14                         
  responses.ts             |   66.66 |        0 |       0 |      50 | 4,7                          
  roomHelpers.ts           |   33.33 |        0 |       0 |   33.33 | 2-5,12-16                    
  userHelpers.ts           |      30 |        0 |       0 |      30 | 14-23                        
---------------------------|---------|----------|---------|---------|------------------------------
